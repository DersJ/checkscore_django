{% extends "teams/header.html" %}
{% load staticfiles %}
{% load crispy_forms_tags %}

{% block javascript %}
  <script>
  	function saveTeam(id) {
	console.log("ajaxing");
	$.ajax({
		url: '{% url "ajax-save-team" %}',
		data: { 'id': id },
		dataType: 'json',
		success: function (data) {
			if (data.saved) {
				alert("team saved");
			}
		}
	});
}
setActive("scraper");
  </script>
{% endblock %}

{% block content %}

<div class="container my-5">
	<div class="row">
		<div class="col">
			<div class="card mb-4">
				<div class="card-body">
					<h3 class="card-title">{{query.get_pageType_display }} Query at {{query.created}} </h3>
					<h6 class="card-subtitle text-muted">Click a row to view more info.</h6>
				</div>
				<ul class="list-group list-group-flush">
					{% for t in teams %}
					<li class="list-group-item team">
					{% if t.thisTeamInDb %}
						{{t.name}} <span class="badge badge-warning">matched</span>
						<p class="url hide"><a href="{{t.eventTeamURL}}" target="blank">{{t.eventTeamURL|truncatechars:40}}</a></p>
						<a href="{{t.thisTeamInDb}}" class="hide save btn btn-outline-dark">View Matched Team</a>
					{% else %}
						{{t.name}} <span class="badge badge-dark">No match</span>
						<p class="url hide"><a href="{{t.eventTeamURL}}"  target="blank">{{t.eventTeamURL|truncatechars:40}}</a></p>
					
					<button onclick="saveTeam({{t.id}})" class="hide save btn btn-success">Save This Team Ajax</a>
					{% endif %}

					</li>
					{% endfor %}
					</ul>

				</div>
				<a href="/scraper/results/" class="btn btn-danger">Back</a>
			</div>
		</div>
	</div>

	{% endblock %}	